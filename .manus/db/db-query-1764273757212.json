{
  "query": "-- Phase 209: Email Template Personalization Engine + Sentiment Heatmap + Smart Scheduling\n\n-- Personalization Templates\nCREATE TABLE IF NOT EXISTS `personalization_templates` (\n  `id` INT AUTO_INCREMENT PRIMARY KEY,\n  `user_id` INT NOT NULL,\n  `name` VARCHAR(255) NOT NULL,\n  `description` TEXT,\n  `base_template` TEXT NOT NULL,\n  `variables` TEXT,\n  `rules` TEXT,\n  `is_active` BOOLEAN DEFAULT TRUE NOT NULL,\n  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL\n);\n\n-- Dynamic Content Blocks\nCREATE TABLE IF NOT EXISTS `dynamic_content_blocks` (\n  `id` INT AUTO_INCREMENT PRIMARY KEY,\n  `template_id` INT NOT NULL,\n  `block_name` VARCHAR(255) NOT NULL,\n  `block_type` ENUM('text', 'image', 'button', 'list', 'conditional') NOT NULL,\n  `content` TEXT NOT NULL,\n  `conditions` TEXT,\n  `priority` INT DEFAULT 0,\n  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL\n);\n\n-- Personalization Rules\nCREATE TABLE IF NOT EXISTS `personalization_rules` (\n  `id` INT AUTO_INCREMENT PRIMARY KEY,\n  `template_id` INT NOT NULL,\n  `rule_name` VARCHAR(255) NOT NULL,\n  `rule_type` ENUM('skill_based', 'experience_based', 'location_based', 'custom') NOT NULL,\n  `conditions` TEXT NOT NULL,\n  `actions` TEXT NOT NULL,\n  `is_active` BOOLEAN DEFAULT TRUE NOT NULL,\n  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL\n);\n\n-- Sentiment Timeline\nCREATE TABLE IF NOT EXISTS `sentiment_timeline` (\n  `id` INT AUTO_INCREMENT PRIMARY KEY,\n  `recording_id` INT NOT NULL,\n  `segment_index` INT NOT NULL,\n  `start_time` INT NOT NULL,\n  `end_time` INT NOT NULL,\n  `sentiment_score` INT NOT NULL,\n  `emotional_tone` ENUM('excited', 'confident', 'neutral', 'hesitant', 'nervous', 'frustrated'),\n  `intensity` INT,\n  `transcript_segment` TEXT,\n  `keywords` TEXT,\n  `is_key_moment` BOOLEAN DEFAULT FALSE,\n  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\n-- Sentiment Analysis Segments\nCREATE TABLE IF NOT EXISTS `sentiment_analysis_segments` (\n  `id` INT AUTO_INCREMENT PRIMARY KEY,\n  `recording_id` INT NOT NULL,\n  `analysis_type` ENUM('overall', 'question_based', 'topic_based', 'time_based') NOT NULL,\n  `segment_data` TEXT NOT NULL,\n  `heatmap_data` TEXT,\n  `key_moments` TEXT,\n  `trend_analysis` TEXT,\n  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL\n);\n\n-- Notification Schedules\nCREATE TABLE IF NOT EXISTS `notification_schedules` (\n  `id` INT AUTO_INCREMENT PRIMARY KEY,\n  `user_id` INT NOT NULL,\n  `candidate_id` INT NOT NULL,\n  `notification_type` VARCHAR(100) NOT NULL,\n  `title` VARCHAR(255) NOT NULL,\n  `body` TEXT NOT NULL,\n  `scheduled_for` TIMESTAMP NOT NULL,\n  `predicted_optimal_time` TIMESTAMP,\n  `timezone` VARCHAR(50),\n  `status` ENUM('scheduled', 'sent', 'delivered', 'failed', 'cancelled') DEFAULT 'scheduled' NOT NULL,\n  `sent_at` TIMESTAMP NULL,\n  `delivered_at` TIMESTAMP NULL,\n  `opened_at` TIMESTAMP NULL,\n  `metadata` TEXT,\n  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL\n);\n\n-- Engagement Patterns\nCREATE TABLE IF NOT EXISTS `engagement_patterns` (\n  `id` INT AUTO_INCREMENT PRIMARY KEY,\n  `candidate_id` INT NOT NULL,\n  `day_of_week` INT,\n  `hour_of_day` INT,\n  `engagement_score` INT,\n  `open_rate` INT,\n  `response_rate` INT,\n  `avg_response_time` INT,\n  `total_notifications` INT DEFAULT 0,\n  `total_opened` INT DEFAULT 0,\n  `total_responded` INT DEFAULT 0,\n  `last_updated` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\n-- Send Time Predictions\nCREATE TABLE IF NOT EXISTS `send_time_predictions` (\n  `id` INT AUTO_INCREMENT PRIMARY KEY,\n  `candidate_id` INT NOT NULL,\n  `notification_type` VARCHAR(100) NOT NULL,\n  `predicted_time` TIMESTAMP NOT NULL,\n  `confidence_score` INT,\n  `factors` TEXT,\n  `timezone` VARCHAR(50),\n  `based_on_patterns` TEXT,\n  `actual_sent_time` TIMESTAMP NULL,\n  `was_opened` BOOLEAN,\n  `opened_at` TIMESTAMP NULL,\n  `prediction_accuracy` INT,\n  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL\n);",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 3HwZw1vuDqLodBY.root --database hjcHA4SjAwhM6aP28vcAkH --execute -- Phase 209: Email Template Personalization Engine + Sentiment Heatmap + Smart Scheduling\n\n-- Personalization Templates\nCREATE TABLE IF NOT EXISTS `personalization_templates` (\n  `id` INT AUTO_INCREMENT PRIMARY KEY,\n  `user_id` INT NOT NULL,\n  `name` VARCHAR(255) NOT NULL,\n  `description` TEXT,\n  `base_template` TEXT NOT NULL,\n  `variables` TEXT,\n  `rules` TEXT,\n  `is_active` BOOLEAN DEFAULT TRUE NOT NULL,\n  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL\n);\n\n-- Dynamic Content Blocks\nCREATE TABLE IF NOT EXISTS `dynamic_content_blocks` (\n  `id` INT AUTO_INCREMENT PRIMARY KEY,\n  `template_id` INT NOT NULL,\n  `block_name` VARCHAR(255) NOT NULL,\n  `block_type` ENUM('text', 'image', 'button', 'list', 'conditional') NOT NULL,\n  `content` TEXT NOT NULL,\n  `conditions` TEXT,\n  `priority` INT DEFAULT 0,\n  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL\n);\n\n-- Personalization Rules\nCREATE TABLE IF NOT EXISTS `personalization_rules` (\n  `id` INT AUTO_INCREMENT PRIMARY KEY,\n  `template_id` INT NOT NULL,\n  `rule_name` VARCHAR(255) NOT NULL,\n  `rule_type` ENUM('skill_based', 'experience_based', 'location_based', 'custom') NOT NULL,\n  `conditions` TEXT NOT NULL,\n  `actions` TEXT NOT NULL,\n  `is_active` BOOLEAN DEFAULT TRUE NOT NULL,\n  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL\n);\n\n-- Sentiment Timeline\nCREATE TABLE IF NOT EXISTS `sentiment_timeline` (\n  `id` INT AUTO_INCREMENT PRIMARY KEY,\n  `recording_id` INT NOT NULL,\n  `segment_index` INT NOT NULL,\n  `start_time` INT NOT NULL,\n  `end_time` INT NOT NULL,\n  `sentiment_score` INT NOT NULL,\n  `emotional_tone` ENUM('excited', 'confident', 'neutral', 'hesitant', 'nervous', 'frustrated'),\n  `intensity` INT,\n  `transcript_segment` TEXT,\n  `keywords` TEXT,\n  `is_key_moment` BOOLEAN DEFAULT FALSE,\n  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\n-- Sentiment Analysis Segments\nCREATE TABLE IF NOT EXISTS `sentiment_analysis_segments` (\n  `id` INT AUTO_INCREMENT PRIMARY KEY,\n  `recording_id` INT NOT NULL,\n  `analysis_type` ENUM('overall', 'question_based', 'topic_based', 'time_based') NOT NULL,\n  `segment_data` TEXT NOT NULL,\n  `heatmap_data` TEXT,\n  `key_moments` TEXT,\n  `trend_analysis` TEXT,\n  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL\n);\n\n-- Notification Schedules\nCREATE TABLE IF NOT EXISTS `notification_schedules` (\n  `id` INT AUTO_INCREMENT PRIMARY KEY,\n  `user_id` INT NOT NULL,\n  `candidate_id` INT NOT NULL,\n  `notification_type` VARCHAR(100) NOT NULL,\n  `title` VARCHAR(255) NOT NULL,\n  `body` TEXT NOT NULL,\n  `scheduled_for` TIMESTAMP NOT NULL,\n  `predicted_optimal_time` TIMESTAMP,\n  `timezone` VARCHAR(50),\n  `status` ENUM('scheduled', 'sent', 'delivered', 'failed', 'cancelled') DEFAULT 'scheduled' NOT NULL,\n  `sent_at` TIMESTAMP NULL,\n  `delivered_at` TIMESTAMP NULL,\n  `opened_at` TIMESTAMP NULL,\n  `metadata` TEXT,\n  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL\n);\n\n-- Engagement Patterns\nCREATE TABLE IF NOT EXISTS `engagement_patterns` (\n  `id` INT AUTO_INCREMENT PRIMARY KEY,\n  `candidate_id` INT NOT NULL,\n  `day_of_week` INT,\n  `hour_of_day` INT,\n  `engagement_score` INT,\n  `open_rate` INT,\n  `response_rate` INT,\n  `avg_response_time` INT,\n  `total_notifications` INT DEFAULT 0,\n  `total_opened` INT DEFAULT 0,\n  `total_responded` INT DEFAULT 0,\n  `last_updated` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\n-- Send Time Predictions\nCREATE TABLE IF NOT EXISTS `send_time_predictions` (\n  `id` INT AUTO_INCREMENT PRIMARY KEY,\n  `candidate_id` INT NOT NULL,\n  `notification_type` VARCHAR(100) NOT NULL,\n  `predicted_time` TIMESTAMP NOT NULL,\n  `confidence_score` INT,\n  `factors` TEXT,\n  `timezone` VARCHAR(50),\n  `based_on_patterns` TEXT,\n  `actual_sent_time` TIMESTAMP NULL,\n  `was_opened` BOOLEAN,\n  `opened_at` TIMESTAMP NULL,\n  `prediction_accuracy` INT,\n  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL\n);",
  "rows": [],
  "messages": [],
  "stdout": "",
  "stderr": "",
  "execution_time_ms": 4225
}